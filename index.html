<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Testador de Endpoints Bags.fm API v1</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    body { font-family: Arial, sans-serif; max-width: 900px; margin: 30px auto; padding: 20px; background: #f9f9f9; }
    h1 { color: #333; }
    label { font-weight: bold; display: block; margin: 15px 0 5px; }
    input, select, textarea { width: 100%; padding: 10px; box-sizing: border-box; font-family: monospace; }
    button { background: #28a745; color: white; border: none; padding: 12px 20px; cursor: pointer; font-size: 16px; margin-top: 10px; }
    button:hover { background: #218838; }
    #response { margin-top: 30px; padding: 15px; background: #fff; border: 1px solid #ddd; white-space: pre-wrap; font-family: monospace; max-height: 600px; overflow-y: auto; }
    .success { border-left: 5px solid #28a745; }
    .error { border-left: 5px solid #dc3545; background: #fff5f5; }
    #endpoints-list { margin-top: 10px; font-size: 0.9em; color: #555; }
  </style>
</head>
<body>
  <h1>Testador de Endpoints Bags.fm API (public-api-v2.bags.fm/api/v1)</h1>
  <p>Insira sua API Key (pegue em <a href="https://dev.bags.fm" target="_blank">dev.bags.fm</a>) e teste os endpoints conhecidos da doc oficial + variações.</p>

  <label>API Key (x-api-key header)</label>
  <input id="apiKey" type="text" placeholder="Sua API Key aqui (obrigatória na maioria)">

  <label>Endpoint (relativo, ex: /ping ou /token-launch/create-token-info)</label>
  <select id="endpoint">
    <option value="/ping">GET /ping (health check - sem key em alguns casos)</option>
    <option value="/token-launch/create-token-info">POST /token-launch/create-token-info (metadata + upload)</option>
    <option value="/token-launch/create-launch-transaction">POST /token-launch/create-launch-transaction (launch tx)</option>
    <option value="/fee-share/config">POST /fee-share/config (fee share config - comum em tipping)</option>
    <option value="/token-launch/fee-share/create-config">POST /token-launch/fee-share/create-config (fee share v2)</option>
    <option value="/create-fee-share-configuration">POST /create-fee-share-configuration (fee share config creation tx)</option>
    <option value="/token-launch/create-config">POST /token-launch/create-config (config antiga?)</option>
    <option value="/fee-share-wallet">GET /fee-share-wallet (get fee share wallet v2)</option>
    <option value="/fee-share-wallet-bulk">POST /fee-share-wallet-bulk (bulk get)</option>
    <option value="/trade/swap">POST /trade/swap (create swap tx)</option>
    <option value="/token-launch/state/pool-config">POST /token-launch/state/pool-config (pool config keys)</option>
    <option value="/token-launch/creator/v3">GET /token-launch/creator/v3 (creators analytics)</option>
    <option value="/token-launch/lifetime-fees">GET /token-launch/lifetime-fees (fees por mint)</option>
    <!-- Adicione mais se quiser testar variações -->
  </select>

  <label>Método</label>
  <select id="method">
    <option value="GET">GET</option>
    <option value="POST" selected>POST</option>
  </select>

  <label>Body JSON (para POST - edite conforme necessário)</label>
  <textarea id="body" rows="6" placeholder='Exemplo para fee-share:
{
  "payer": "SuaWalletBase58",
  "baseMint": "SeuMintAqui",
  "feeClaimers": [{"user": "SuaWalletBase58", "userBps": 10000}]
}'>
{
  "payer": "INSIRA_SUA_WALLET_AQUI_SE_NECESSARIO",
  "baseMint": "INSIRA_MINT_AQUI_SE_NECESSARIO",
  "feeClaimers": [
    {
      "user": "INSIRA_WALLET_AQUI",
      "userBps": 10000
    }
  ]
}
</textarea>

  <button onclick="testEndpoint()">Testar Endpoint</button>

  <div id="response">Resultado aparecerá aqui...</div>

  <div id="endpoints-list">
    <p><strong>Endpoints confirmados na doc (2026):</strong> /ping, /token-launch/create-token-info, /token-launch/create-launch-transaction, /fee-share/config, /token-launch/fee-share/create-config, /create-fee-share-configuration, /fee-share-wallet, /trade/swap, etc.</p>
    <p>Se algum retornar 200 + JSON válido → é o endpoint correto! Se 404/405 → não existe. 500 → erro interno (parâmetro errado).</p>
  </div>

  <script>
    async function testEndpoint() {
      const apiKey = document.getElementById('apiKey').value.trim();
      const endpoint = document.getElementById('endpoint').value.trim();
      const method = document.getElementById('method').value;
      const bodyText = document.getElementById('body').value.trim();
      const responseDiv = document.getElementById('response');

      if (!apiKey && endpoint !== '/ping') {
        responseDiv.innerHTML = '<span class="error">API Key é obrigatória para a maioria dos endpoints (exceto /ping).</span>';
        return;
      }

      responseDiv.innerHTML = 'Carregando... (aguarde 5-10s)';

      const url = `https://public-api-v2.bags.fm/api/v1${endpoint}`;
      const options = {
        method: method,
        headers: {
          'x-api-key': apiKey
        }
      };

      if (method === 'POST' && bodyText) {
        try {
          const jsonBody = JSON.parse(bodyText);
          options.headers['Content-Type'] = 'application/json';
          options.body = JSON.stringify(jsonBody);
        } catch (e) {
          responseDiv.innerHTML = `<span class="error">Erro no JSON do body: ${e.message}</span>`;
          return;
        }
      }

      try {
        const res = await fetch(url, options);
        const text = await res.text();

        let content = `Status: ${res.status} ${res.statusText}\n`;
        content += `URL: ${url}\n`;
        content += `Headers de resposta:\n`;
        res.headers.forEach((v, k) => { content += `  ${k}: ${v}\n`; });

        content += `\nBody:\n${text.substring(0, 2000)}${text.length > 2000 ? '...\n(truncado)' : ''}`;

        const className = res.ok ? 'success' : 'error';
        responseDiv.innerHTML = `<div class="${className}">${content}</div>`;
      } catch (err) {
        responseDiv.innerHTML = `<span class="error">Erro na requisição: ${err.message}</span>`;
      }
    }
  </script>
</body>
</html>
